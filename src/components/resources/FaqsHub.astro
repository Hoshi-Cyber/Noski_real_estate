---
import BaseCard from '../BaseCard.astro';

/** FAQs hub: hero + search + grouped links */
const {
  title = 'FAQs',
  intro = 'Quick answers grouped by topic.',
  groups = /** [{ name, href, count }] */ [
    { name: 'Buying', href: '/resources/faqs/buying', count: 12 },
    { name: 'Selling', href: '/resources/faqs/selling', count: 10 },
    { name: 'Renting', href: '/resources/faqs/renting', count: 9 },
    { name: 'Short-Stay', href: '/resources/faqs/short-stay', count: 8 },
  ],
} = Astro.props;
---

<section class="max-w-7xl mx-auto px-4 py-8 md:py-10">
  <!-- Header -->
  <header class="mb-6 md:mb-8">
    <h1 class="text-2xl md:text-3xl font-bold text-primary">{title}</h1>
    <p class="mt-2 text-neutral-700">{intro}</p>

    <!-- Search -->
    <form role="search" aria-label="Search FAQs" class="mt-4">
      <label for="faq-search" class="sr-only">Search FAQs</label>
      <input
        id="faq-search"
        type="search"
        placeholder="Search FAQs"
        class="w-full max-w-lg rounded-md border border-neutral-300 px-3 py-2 text-sm
               focus:outline-none focus:ring-2 focus:ring-[color:var(--color-cta)]"
      />
    </form>
  </header>

  <!-- FAQ Groups -->
  <div id="faq-groups" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
    {groups.map((g) => (
      <div data-title={g.name}>
        <BaseCard
          title={g.name}
          desc={`Browse ${g.name} questions`}
          href={g.href}
          tag="FAQ"
          cta={`${g.count} Qs â†’`}
          variant="compact"
          showImage={false}
        />
      </div>
    ))}
  </div>
</section>

<script type="module" client:load>
  const q = document.getElementById('faq-search');
  const container = document.getElementById('faq-groups');

  if (q && container) {
    q.addEventListener('input', () => {
      const term = q.value.trim().toLowerCase();
      container.querySelectorAll('[data-title]').forEach((el) => {
        const t = el.getAttribute('data-title')?.toLowerCase() || '';
        el.classList.toggle('hidden', !!term && !t.includes(term));
      });
    });
  }
</script>
