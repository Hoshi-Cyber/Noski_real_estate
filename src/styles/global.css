@tailwind base;
@tailwind components;
@tailwind utilities;

/* ---- Base Tokens ---- */
:root {
  /* Brand */
  --color-primary: #0A2A42; /* Primary */
  --color-primary-90: color-mix(in srgb, #0A2A42 88%, #000 12%);
  --color-primary-active: color-mix(in srgb, #0A2A42 80%, #000 20%);

  /* Accent / CTA = Teal */
  --color-accent: #4A7F96;           /* Accent Teal */
  --color-cta: var(--color-accent);  /* unify CTAs to teal */
  --color-cta-90: color-mix(in srgb, var(--color-accent) 88%, #000 12%);
  --color-cta-active: color-mix(in srgb, var(--color-accent) 80%, #000 20%);

  /* Neutrals (per spec) */
  --color-neutral-50:  #F9F9F9; /* Neutral Light */
  --color-neutral-100: #F3F1ED; /* Secondary */
  --color-neutral-200: #E7E5E0;
  --color-neutral-300: #D6D3CE;
  --color-neutral-500: #6B7280;
  --color-neutral-600: #4B5563;
  --color-neutral-700: #374151; /* added */
  --color-neutral-800: #394449; /* Neutral Dark for body text */

  /* Typography */
  --font-sans: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  --font-serif: "Merriweather", Georgia, serif;
  --font-mono: "Fira Code", monospace;

  /* Accent palette for pills */
  --emerald: #10B981;
  --purple:  #7C3AED;
  --slate:   #334155;

  /* Spacing */
  --space-section: 4rem;

  /* Breakpoints */
  --bp-xs: 320px;
  --bp-sm: 640px;
  --bp-md: 768px;
  --bp-lg: 1024px;
  --bp-xl: 1280px;
  --bp-2xl: 1536px;
}

/* ---- Base Styles ---- */
body {
  @apply font-sans antialiased;
  color: var(--color-neutral-800);
  background: var(--color-neutral-100);
  font-family: var(--font-sans);
}

h1, h2, h3, h4, h5, h6 {
  @apply font-bold tracking-tight;
  color: var(--color-primary);
}

a {
  @apply transition-colors underline-offset-2;
  color: var(--color-primary);
}
a:hover   { color: var(--color-primary-90); }
a:active  { color: var(--color-primary-active); }
a:focus-visible { outline: 2px solid var(--color-primary); outline-offset: 2px; }
a:disabled {
  color: var(--color-neutral-500);
  pointer-events: none;
}

/* helper for focus without bracket utilities in markup */
.ring-focus-brand:focus-visible { outline: 2px solid var(--color-cta); outline-offset: 2px; }

/* ---- Utilities ---- */
@layer utilities {
  .text-primary   { color: var(--color-primary); }
  .text-accent    { color: var(--color-accent); }
  .text-cta       { color: var(--color-cta); }

  .bg-primary     { background-color: var(--color-primary); }
  .bg-primary-90  { background-color: var(--color-primary-90); }
  .bg-primary-act { background-color: var(--color-primary-active); }
  .bg-accent      { background-color: var(--color-accent); }
  .bg-cta         { background-color: var(--color-cta); }
  .bg-cta-90      { background-color: var(--color-cta-90); }
  .bg-cta-act     { background-color: var(--color-cta-active); }

  .border-primary { border-color: var(--color-primary); }
  .border-accent  { border-color: var(--color-accent); }
  .border-cta     { border-color: var(--color-cta); }

  /* Section spacing (reduced) */
  .section { @apply py-12 px-4 sm:px-6 lg:px-8; }
  @media (min-width: 768px){ .section { @apply py-14; } }
  @media (min-width: 1280px){ .section { @apply py-16; } }

  /* Responsive container */
  .container { @apply max-w-7xl mx-auto; }

  /* Surface utilities to match header styling */
  .surface          { @apply ring-1; background:#fff;                 border-color: var(--color-neutral-200); }
  .surface-muted    { @apply ring-1; background: var(--color-neutral-50); border-color: var(--color-neutral-200); }
  .surface-translucent { background-color: rgb(255 255 255 / .9); -webkit-backdrop-filter: blur(8px); backdrop-filter: blur(8px); }

  /* Subtle fact label text (used beside price) */
  .fact-label { @apply text-sm; color: var(--color-neutral-700); }

  /* Single-line ellipsis */
  .truncate-1 { @apply truncate; }

  /* ---- Guides grid helpers ---- */
  .grid-auto-cards { display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:1rem; }
  @media (min-width: 768px){ .grid-auto-cards{ gap:1.25rem; } }
  @media (min-width: 1024px){ .grid-auto-cards{ gap:1.5rem; } }

  .grid-steps { display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:1rem; align-items:stretch; }
  @media (min-width: 768px){ .grid-steps{ gap:1.25rem; } }
  @media (min-width: 1024px){ .grid-steps{ gap:1.5rem; } }

  /* Avoid orphan when exactly 4 step cards */
  .grid-steps[data-count="4"]{ grid-template-columns: repeat(2, minmax(260px,1fr)); }

  /* Clamp helper for balanced cards */
  .line-clamp-2{ display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }

  /* Optional aspect helpers */
  .aspect-4-3-sm { aspect-ratio: 4 / 3; }
  @media (min-width: 768px){ .aspect-16-9-md { aspect-ratio: 16 / 9; } }
}

/* ---- Components ---- */
@layer components {
  /* ---- Buttons ---- */
  .btn {
    @apply inline-flex items-center justify-center px-6 py-3 rounded-md font-medium transition shadow-sm
           disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .btn-primary { @apply text-white; background-color: var(--color-primary); }
  .btn-primary:hover   { background-color: var(--color-primary-90); }
  .btn-primary:active  { background-color: var(--color-primary-active); }
  .btn-primary:focus-visible { outline: 2px solid var(--color-primary); outline-offset: 2px; }
  .btn-primary:disabled{ background-color: var(--color-neutral-300); }

  /* Primary CTA uses --color-cta (teal) */
  .btn-cta {
    @apply inline-flex items-center justify-center px-6 py-3 rounded-md font-semibold text-white transition shadow-sm;
    background-color: var(--color-cta);
  }
  .btn-cta:hover   { background-color: var(--color-cta-90); }
  .btn-cta:active  { background-color: var(--color-cta-active); }
  .btn-cta:focus-visible { outline: 2px solid var(--color-cta); outline-offset: 2px; }
  .btn-cta:disabled{ background-color: var(--color-neutral-300); }

  /* Fluid CTA sizing for all screens */
  .cta-fluid{
    font-size: clamp(.9rem, .85rem + .3vw, 1rem);
    padding-inline: clamp(1rem, 2.5vw, 1.25rem);
    padding-block: clamp(.55rem, .5rem + .3vw, .8rem);
    line-height: 1.2;
    min-height: 40px;
    display: inline-flex;
    gap: .5rem;
    max-width: 100%;
    white-space: nowrap;
  }
  @media (max-width: 360px){
    .cta-fluid{ font-size: .9rem; padding-inline: .9rem; padding-block: .5rem; min-height: 36px; }
  }

  /* Tertiary action */
  .btn-subtle{
    @apply inline-flex items-center justify-center px-3 py-2 rounded-md text-sm font-medium border transition;
    border-color: var(--color-neutral-300);
    color: var(--color-primary);
    background:#fff;
  }
  .btn-subtle:hover{ background: var(--color-neutral-100); }

  /* Secondary CTA uses --color-accent (teal outline) */
  .btn-outline {
    @apply inline-flex items-center justify-center px-5 py-2.5 rounded-md font-medium transition;
    border: 1px solid var(--color-accent);
    color: var(--color-accent);
    background-color: transparent;
  }
  .btn-outline:hover   { background-color: color-mix(in srgb, var(--color-accent) 10%, transparent); }
  .btn-outline:active  { background-color: color-mix(in srgb, var(--color-accent) 18%, transparent); }
  .btn-outline:focus-visible { outline: 2px solid var(--color-accent); outline-offset: 2px; }
  .btn-outline:disabled{ color: var(--color-neutral-500); border-color: var(--color-neutral-300); }

  /* WhatsApp CTA (kept for other pages) */
  .btn-wa{ @apply inline-flex items-center justify-center rounded-md px-4 py-2 font-semibold text-white transition; background:#25D366; }
  .btn-wa:hover{ background:#1fb257; }
  .btn-wa:focus-visible{ outline:2px solid #25D366; outline-offset:2px; }
  .btn-wa svg{ width:16px; height:16px; display:block; }

  /* Icon button (40×40 circular) */
  .icon-btn{ @apply inline-flex items-center justify-center w-10 h-10 rounded-full bg-white text-neutral-700 shadow ring-1 ring-neutral-200; }
  .icon-btn:focus-visible{ outline: 2px solid var(--color-cta); outline-offset: 2px; }

  /* WhatsApp icon button */
  .btn-wa-icon{ @apply icon-btn text-white; background:#25D366; }
  .btn-wa-icon:hover{ background:#1fb257; }
  .btn-wa-icon:focus-visible{ outline:2px solid #25D366; outline-offset:2px; }

  /* Unified carousel buttons */
  .carousel-btn { @apply inline-flex items-center justify-center rounded-md px-3 py-2 text-white focus:outline-none transition; background-color: rgb(0 0 0 / .45); }
  .carousel-btn:hover { background-color: rgb(0 0 0 / .6); }
  .carousel-btn:focus-visible { outline: 2px solid var(--color-cta); outline-offset: 2px; }

  /* Pagination (shared by pagination.js) */
  .pg-btn,
  .pg-num {
    @apply inline-flex items-center justify-center px-3 py-1.5 rounded-md border border-neutral-300 text-sm text-neutral-800 hover:bg-neutral-50 transition;
  }
  .pg-active {
    @apply bg-emerald-600 text-white font-semibold border-transparent;
  }
  .pg-disabled {
    @apply pointer-events-none opacity-50;
  }

  /* ---- Badges ---- */
  .badge{ @apply inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-[11px] font-medium ring-1 ring-neutral-200 bg-neutral-50 text-neutral-700; }
  .badge-cta{
    @apply inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-[11px] font-semibold;
    color: var(--color-cta);
    background-color: color-mix(in srgb, var(--color-cta) 12%, transparent);
    box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--color-cta) 30%, transparent);
  }
  .badge-warn{
    @apply inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-[11px] font-semibold;
    color: var(--color-accent);
    background-color: color-mix(in srgb, var(--color-accent) 14%, transparent);
    box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--color-accent) 35%, transparent);
  }

  /* ---- Pills ---- */
  .pill { @apply inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium select-none; background: var(--color-neutral-100); color: var(--color-neutral-800); box-shadow: inset 0 0 0 1px var(--color-neutral-200); }
  .pill-dot { @apply w-1.5 h-1.5 rounded-full; background: var(--color-cta); }
  .pill-blue   { color: var(--color-cta);     background-color: color-mix(in srgb, var(--color-cta) 12%, transparent);     box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--color-cta) 28%, transparent); }
  .pill-amber  { color: var(--color-accent);  background-color: color-mix(in srgb, var(--color-accent) 14%, transparent);  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--color-accent) 32%, transparent); }
  .pill-emerald{ color: var(--emerald);       background-color: color-mix(in srgb, var(--emerald) 14%, transparent);       box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--emerald) 32%, transparent); }
  .pill-purple { color: var(--purple);        background-color: color-mix(in srgb, var(--purple) 14%, transparent);        box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--purple) 32%, transparent); }
  .pill-slate  { color: var(--slate);         background-color: color-mix(in srgb, var(--slate) 12%, transparent);         box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--slate) 30%, transparent); }

  /* ---- Cards ---- */
  .card           { @apply bg-white rounded-xl shadow ring-1 ring-neutral-200 hover:shadow-md transition; }
  .card-tight     { @apply bg-white rounded-lg shadow p-4 ring-1 ring-neutral-200; }
  .card-highlight { @apply border-2 border-cta ring-1 ring-cta; }

  .card-horizontal img { @apply w-40 h-40 object-cover; }
  .card-horizontal .content { @apply flex flex-col justify-between p-4 flex-1; }

  /* ---- Breadcrumbs ---- */
  .breadcrumb { @apply max-w-6xl mx-auto px-4 py-3 text-sm; }
  @media (min-width: 768px) { .breadcrumb { font-size: 15px; line-height: 1.4; } }
  .breadcrumb-ol {
    @apply flex items-center gap-1.5 flex-wrap rounded-md bg-neutral-50 ring-1 ring-neutral-200 px-3 py-2;
    overflow-x: auto; -ms-overflow-style: none; scrollbar-width: none;
  }
  .breadcrumb-ol::-webkit-scrollbar { display: none; }
  .breadcrumb a { @apply text-primary font-normal no-underline hover:text-cta; }
  .breadcrumb-sep { @apply text-neutral-400 px-1; }
  .breadcrumb-current { @apply text-neutral-700 font-normal; }

  /* ---- Bulleted grids ---- */
  .bullets { @apply grid gap-y-1 gap-x-8 list-disc pl-5; }
  .bullets-2 { @apply md:grid-cols-2; }
  .bullets-3 { @apply md:grid-cols-2 lg:grid-cols-3; }

  /* ---- Category Tile ---- */
  .category-tile {
    @apply relative flex flex-col items-start p-6 rounded-2xl bg-white shadow-sm
           ring-1 ring-neutral-200 transition hover:shadow-md hover:-translate-y-0.5;
    background-image: linear-gradient(180deg, rgba(10,42,66,.02), rgba(10,42,66,0));
  }
  .category-tile:focus-visible { outline: 2px solid var(--color-cta); outline-offset: 2px; }
  .tile-accent::after{ content:""; @apply absolute inset-x-6 top-14 h-px bg-neutral-200; }
  .tile-icon  { @apply w-10 h-10 rounded-lg bg-neutral-100 flex items-center justify-center text-primary mb-4; }
  .tile-title { @apply text-lg font-semibold text-primary; }
  .tile-sub   { @apply text-sm text-neutral-600 mt-1; }

  .tile-hover { @apply hover:-translate-y-0.5 hover:shadow-md transition; }
  .tile-badge { @apply w-10 h-10 rounded-lg bg-neutral-100 flex items-center justify-center text-primary mb-4 ring-1 ring-neutral-200; }
  .tile-icon-svg { width: 20px; height: 20px; display: block; }
  .category-tile:hover .tile-badge { @apply bg-cta text-white ring-cta; }

  /* NEW: subtle brand tint to help tiles stand out */
  .tile-tint{
    background-image:
      radial-gradient(80% 60% at 10% -10%, color-mix(in srgb, var(--color-cta) 9%, transparent), transparent),
      linear-gradient(180deg, rgba(10,42,66,.02), rgba(10,42,66,0));
    border: 1px solid color-mix(in srgb, var(--color-cta) 22%, var(--color-neutral-200));
    box-shadow: 0 1px 0 0 color-mix(in srgb, var(--color-cta) 18%, transparent) inset;
  }
  .tile-tint:hover{ box-shadow: 0 8px 16px rgb(0 0 0 / .06), 0 2px 3px rgb(74 127 150 / .08); }
  .tile-tint .tile-badge{
    background-color: color-mix(in srgb, var(--color-cta) 12%, #fff);
    color: var(--color-cta);
    box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--color-cta) 30%, transparent);
  }

  /* === Explore Categories (Homepage) ===================================== */
  .cat-rail {
    scroll-snap-type: x mandatory;
    overscroll-behavior-x: contain;
    contain: content;
  }
  .cat-rail::-webkit-scrollbar { display: none; }
  .cat-rail > * { scroll-snap-align: start; scroll-snap-stop: always; }
  .cat-rail[data-dragging="true"] { cursor: grabbing; }

  .cat-tile { @apply items-center text-center; }
  .cat-tile .tile-badge { @apply mb-3; }
  .cat-tile .tile-title { @apply font-semibold text-primary; }
  .cat-tile .tile-sub { @apply text-sm text-neutral-600 mt-1; }

  /* ---- FAQ card tint ---- */
  .faq-card{
    background:
      radial-gradient(85% 70% at 10% -10%, color-mix(in srgb, var(--color-cta) 6%, transparent), transparent),
      #fff;
    border: 1px solid color-mix(in srgb, var(--color-cta) 18%, var(--color-neutral-200));
    box-shadow: 0 1px 2px rgb(0 0 0 / .04);
    transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
  }
  .faq-card:hover{
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgb(0 0 0 / .08);
    border-color: color-mix(in srgb, var(--color-cta) 28%, var(--color-neutral-200));
  }

  /* ---- Area Card ---- */
  .area-card { @apply shrink-0 snap-start basis-2/3 sm:basis-1/3 md:basis-1/4 lg:basis-1/5 p-4 rounded-lg bg-white shadow-sm hover:shadow-md text-center transition ring-1 ring-neutral-200; }
  .area-card span { @apply font-semibold text-neutral-700; }
  .area-card:focus-visible { outline: 2px solid var(--color-cta); outline-offset: 2px; }

  /* ---- Chip links ---- */
  .chip-link { @apply shrink-0 snap-start px-4 py-2 rounded-full border border-neutral-300 text-sm text-neutral-700 hover:bg-neutral-100 transition whitespace-nowrap; }

  /* ---- TOC ---- */
  .toc-card { @apply rounded-2xl ring-1 ring-neutral-200 bg-white p-4 text-sm shadow-sm lg:sticky lg:top-20; max-height:70vh; overflow:auto; }
  .toc-list a { @apply block rounded px-2 py-1 hover:underline hover:text-cta transition; }
  .toc-list a:focus-visible { outline: 2px solid var(--color-cta); outline-offset: 2px; }

  .toc-overlay{
    position:absolute; left:1rem; bottom:1rem;
    max-width:420px;
    padding:.85rem .9rem;
    border-radius:.75rem;
    background: color-mix(in srgb, #ffffff 78%, transparent);
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 18px rgb(0 0 0 / 0.12);
    border: 1px solid var(--color-neutral-200);
  }
  .toc-overlay__title{
    margin:0 0 .5rem 0;
    font-size:.85rem;
    font-weight:700;
    color:#0f172a;
    letter-spacing:.01em;
  }
  .toc-overlay__list{
    display:grid;
    gap:.35rem;
    max-height:42vh;
    overflow:auto;
    padding-right:.25rem;
  }
  .toc-overlay__link{
    display:block;
    padding:.4rem .5rem;
    border-radius:.5rem;
    color:#0f172a;
    text-decoration:none;
    border-bottom:1px dotted currentColor;
    padding-bottom:1px;
  }
  .toc-overlay__link:hover{
    background: color-mix(in srgb, var(--color-cta) 10%, transparent);
    border-bottom-style:solid;
    color: var(--color-primary);
  }
  .toc-overlay__link:focus-visible{
    outline:2px solid var(--color-cta);
    outline-offset:2px;
  }

  /* ---- PDF Badge ---- */
  .pdf-badge { @apply inline-flex items-center gap-1 px-2 py-0.5 text-xs font-semibold rounded-full bg-red-50 text-red-700 border border-red-200; }

  /* ---- Related Guides ---- */
  .rel-card{ @apply block rounded-2xl border border-neutral-200 bg-white shadow-sm hover:shadow-md transition; }
  .rel-card--compact{ @apply p-5 flex flex-col gap-2; }
  .rel-card--compact .rel-title{ @apply font-semibold text-primary; }
  .rel-card--compact .rel-desc{ @apply text-sm text-neutral-600; }
  .rel-card--compact .rel-read{ @apply text-sm text-cta; }

  /* ---- Why Choose Us ---- */
  /* =========================
     WHY CHOOSE US SECTION
     ========================= */

  .why-card {
    @apply relative rounded-2xl p-6 shadow-sm transition transform bg-white/90;
    overflow: hidden;
  }
  .why-card:hover { @apply -translate-y-1 shadow-md; }

  .why-label { @apply text-lg font-semibold text-primary; }

  .why-icon {
    @apply w-10 h-10 mx-auto;
    stroke-width: 1.6;
    color: var(--color-primary);
  }

  .why-card::before {
    content: "";
    position: absolute;
    inset: 0;
    padding: 1px;
    border-radius: inherit;
    background: linear-gradient(135deg, #e5e7eb, #ffffff);
    -webkit-mask:
      linear-gradient(#fff 0 0) content-box,
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
            mask-composite: exclude;
    pointer-events: none;
  }

  .why-card--tint.tint-blue    { background: linear-gradient(to bottom right, #eff6ff, #ffffff); }
  .why-card--tint.tint-amber   { background: linear-gradient(to bottom right, #fff8eb, #ffffff); }
  .why-card--tint.tint-emerald { background: linear-gradient(to bottom right, #ecfdf5, #ffffff); }
  .why-card--tint.tint-purple  { background: linear-gradient(to bottom right, #f5f3ff, #ffffff); }

  .why-card--tint.tint-blue::before    { background: linear-gradient(135deg, #3b82f6, #93c5fd); }
  .why-card--tint.tint-amber::before   { background: linear-gradient(135deg, #fbbf24, #fde68a); }
  .why-card--tint.tint-emerald::before { background: linear-gradient(135deg, #10b981, #6ee7b7); }
  .why-card--tint.tint-purple::before  { background: linear-gradient(135deg, #8b5cf6, #c4b5fd); }

  .why-card--tint.tint-blue .why-icon    { color:#3b82f6; }
  .why-card--tint.tint-amber .why-icon   { color:#f59e0b; }
  .why-card--tint.tint-emerald .why-icon { color:#10b981; }
  .why-card--tint.tint-purple .why-icon  { color:#8b5cf6; }

  .why-card--tint.tint-blue:hover    { box-shadow: 0 6px 16px rgba(59,130,246,.25); }
  .why-card--tint.tint-amber:hover   { box-shadow: 0 6px 16px rgba(251,191,36,.25); }
  .why-card--tint.tint-emerald:hover { box-shadow: 0 6px 16px rgba(16,185,129,.25); }
  .why-card--tint.tint-purple:hover  { box-shadow: 0 6px 16px rgba(139,92,246,.25); }

  @media (min-width: 640px){ .why-card { @apply p-8; } }

  /* ---- Section headers ---- */
  .section-title { @apply text-2xl md:text-3xl font-bold text-primary mb-8 text-center; }
  .section-subtitle { @apply text-sm font-semibold text-neutral-700 uppercase tracking-wide; }

  /* ---- Landing page section headers (shared) ---- */
  .landing-head{
    display:flex;
    align-items:flex-end;
    justify-content:space-between;
    gap:.5rem;
    min-width:0;
  }
  @media (max-width:640px){
    .landing-head{ flex-direction:column; align-items:flex-start; }
  }
  .landing-h2{
    font-weight:800;
    letter-spacing:-.01em;
    color: var(--color-primary);
    line-height:1.2;
    white-space:nowrap;
    font-size: clamp(1.05rem, 0.9rem + 1.2vw, 1.375rem);
    display:inline-flex; align-items:center; gap:.5rem;
  }
  .landing-h2::after{
    content:"";
    display:inline-block;
    height:.45em; width:36px;
    border-radius:9999px;
    background: color-mix(in srgb, var(--color-cta) 70%, transparent);
  }
  @media (min-width:640px){
    .landing-h2{ font-size:1.25rem; }
    .landing-h2::after{ width:44px; }
  }

  /* ---- Popular Articles (base) ---- */
  .post-card  { @apply bg-white rounded-2xl shadow ring-1 ring-neutral-200 overflow-hidden hover:shadow-md transition; }
  .post-media { @apply w-full h-44 object-cover; }
  .post-body  { @apply p-4; }
  .post-title { @apply font-semibold leading-snug text-primary; }
  .post-desc  { @apply text-sm text-neutral-600 mt-1; }
  .post-meta  { @apply mt-3 text-sm text-neutral-500 flex items-center justify-between; }

  /* ---- Popular Articles: stack variant ---- */
  .post-card--stack .post-title{ font-size:1.05rem; line-height:1.35; font-weight:700; }
  .post-card--stack .post-desc{ display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden; }
  .post-card--stack .post-footer{ @apply mt-3 flex items-center justify-between; }
  .post-card--stack .post-media{ width:100%; height:auto; object-fit:cover; aspect-ratio: 16/10; }
  @media (max-width: 640px){ .post-card--stack .post-media{ aspect-ratio:4/3; } }

  /* ---- Popular Articles: richer variant ---- */
  .post-card--rich { transform: translateZ(0); }
  .post-card--rich:hover { box-shadow: 0 12px 24px rgba(0,0,0,.09); transform: translateY(-2px); }
  .post-card--rich .post-media-wrap{ position: relative; overflow: hidden; aspect-ratio: 16 / 10; border-bottom: 1px solid var(--color-neutral-200); }
  .post-card--rich .post-media{ width: 100%; height: 100%; object-fit: cover; transform: scale(1.02); transition: transform .35s ease; }
  .post-card--rich:hover .post-media{ transform: scale(1.06); }
  .post-card--rich .post-media-wrap::after{
    content:""; position:absolute; inset:0;
    background: linear-gradient(to top, rgba(255,255,255,0.0) 40%, rgba(10,42,66,.10));
    opacity:.75; transition: opacity .25s ease;
  }
  .post-card--rich:hover .post-media-wrap::after{ opacity:.95; }
  .post-card--rich .post-body{ padding: 1rem; }
  .post-card--rich .post-title{ font-size: 1.05rem; line-height: 1.35; color: var(--color-primary); font-weight: 700; }
  .post-card--rich .post-desc{ font-size: .925rem; color: var(--color-neutral-600); margin-top: .25rem; }
  .post-card--rich .post-meta{ margin-top: .6rem; font-size: .875rem; color: var(--color-neutral-500); display:flex; align-items:center; justify-content:space-between; }

  /* ---- Popular Articles: image-overlay variant ---- */
  .post-card--overlay { position: relative; }
  .post-card--overlay .post-media-wrap{ position: relative; display:block; overflow:hidden; aspect-ratio: 16 / 10; }
  .post-card--overlay .post-media{ width:100%; height:100%; object-fit:cover; display:block; transition: transform .35s ease; }
  .post-card--overlay:hover .post-media{ transform: scale(1.06); }
  .post-card--overlay .post-overlay{
    position:absolute; left:0; right:0; bottom:0; padding:.75rem .9rem; color:#fff;
    background: linear-gradient(to top, rgba(10,42,66,.88), rgba(10,42,66,0) 70%);
  }
  .post-card--overlay .post-title{ margin:0 0 .2rem 0; color:#fff; font-weight:700; font-size:1rem; line-height:1.35; }
  .post-card--overlay .post-excerpt{
    margin:0; font-size:.875rem; color:rgba(255,255,255,.92);
    display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden;
  }
  .post-card--overlay .post-meta-inline{
    margin-top:.35rem; display:flex; align-items:center; justify-content:space-between;
    font-size:.8rem; color:rgba(255,255,255,.85);
  }
  .post-card--overlay .read{ border-bottom:1px dotted currentColor; }
  .post-card--overlay:hover .read{ border-bottom-style:solid; }

  /* ---- Dialog / Sheet ---- */
  .sheet{ @apply bg-white rounded-xl shadow-xl ring-1 ring-neutral-200 max-h-[85vh] overflow-auto; }
  .sheet--mobile{ @apply fixed inset-x-0 bottom-0 rounded-t-2xl shadow-xl ring-1 ring-neutral-200 bg-white max-h-[85vh] overflow-auto; }
  .sheet__header{ @apply sticky top-0 z-10 bg-white px-4 py-3 border-b flex items-center justify-between; }
  .sheet__body{ @apply p-4; }
  .sheet__footer--sticky{ @apply sticky bottom-0 bg-white p-3 border-t; }
  
  /* ---- Popover ---- */
  .popover{ @apply absolute mt-2 min-w-[12rem] bg-white ring-1 ring-neutral-200 rounded-md shadow-lg p-2 z-20; }
  .popover-arrow{
    position:absolute; width:10px; height:10px; transform:rotate(45deg);
    background:#fff; border-left:1px solid rgb(229 231 235); border-top:1px solid rgb(229 231 235);
    top:-5px; left:16px;
  }

  /* ---- Share bars ---- */
  .share-bar{ @apply mt-4 flex items-center gap-2 flex-wrap; }
  .share-label{ @apply text-sm text-neutral-700 mr-1; }
  .share-btn{
    appearance:none; -webkit-appearance:none;
    @apply inline-flex items-center gap-2 px-2.5 py-2 rounded-md border border-neutral-300 bg-white text-neutral-800 text-sm transition;
    text-decoration: none;
  }
  .share-btn:hover{ @apply bg-neutral-100 border-neutral-400; }
  .share-btn:focus{ outline:2px solid var(--color-cta); outline-offset:2px; }
  .share-btn svg{ width:16px; height:16px; display:block; }

  .share-btn-icon{ @apply w-9 h-9 p-0 justify-center; }

  /* ---- Guides: Step cards and detail blocks ---- */
  .step-card { @apply rounded-2xl border border-neutral-200 bg-white shadow-sm p-5 transition hover:shadow-md focus-within:shadow-md; display:flex; flex-direction:column; }
  .step-head { @apply flex items-start gap-3; }
  .step-index { @apply w-9 h-9 rounded-full grid place-items-center font-semibold bg-neutral-800 text-white shrink-0; }
  .step-title { @apply text-lg font-semibold leading-snug text-primary; }
  .step-body { @apply mt-3 text-neutral-700 text-sm; }
  .step-actions { @apply mt-4 flex flex-wrap gap-3; }

  .detail-list { @apply space-y-8; counter-reset: step; }
  .detail-item { @apply bg-white border border-neutral-200 rounded-2xl p-5 shadow-sm; }
  .detail-head { @apply flex items-center gap-3; }
  .detail-index { @apply w-8 h-8 rounded-full grid place-items-center font-semibold bg-neutral-800 text-white; }
  .detail-body { @apply mt-3; }
  .detail-actions { @apply mt-4 flex items-center gap-4; }

  /* === Knowledge Hub ===================================================== */
  .hub-head { @apply mb-6 text-center; }
  .hub-sub  { @apply text-sm text-neutral-600 max-w-2xl mx-auto; }

  .hub-grid {
    display:grid;
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  @media (min-width:768px){
    .hub-grid{ grid-template-columns: 1fr 1fr; gap: 2rem; }
  }

  .hub-feature { overflow:hidden; }
  .hub-feature .post-body{ padding:1rem; }
  @media (min-width:768px){ .hub-feature .post-body{ padding:1.1rem; } }

  .hub-chip{
    position:absolute; top:.75rem; left:.75rem;
    @apply inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold;
    color: var(--color-cta);
    background-color: color-mix(in srgb, var(--color-cta) 12%, #fff);
    box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--color-cta) 30%, transparent);
  }

  .hub-res { @apply p-4; }
  @media (min-width:768px){ .hub-res{ @apply p-5; } }

  .hub-thumb{
    @apply shrink-0 rounded-lg ring-1 ring-neutral-200 overflow-hidden bg-neutral-100;
    width:96px; height:96px; flex:none;
  }
  .hub-thumb__img{ width:100%; height:100%; object-fit:cover; display:block; }

  .hub-link{
    @apply inline-block mt-2 text-sm font-semibold;
    color: var(--color-cta);
    border-bottom: 1px dotted currentColor;
    padding-bottom: 1px;
  }
  .hub-link:hover{ border-bottom-style: solid; }
  .hub-link:focus-visible{ outline:2px solid var(--color-cta); outline-offset:2px; }

  .hub-meta{ @apply text-sm text-neutral-500; }

  .hub-grid article:hover { transform: translateY(-2px); transition: transform .2s ease; }
}

/* Knowledge Hub section background polish */
.section.bg-neutral-50 {
  background:
    radial-gradient(100% 60% at 0% 0%, rgba(74,127,150,.06), transparent 60%),
    var(--color-neutral-50);
}

/* Field validation */
input:invalid, select:invalid, textarea:invalid { @apply border-red-400; }

/* ---- Footer (on-dark) link overrides ---- */
footer.bg-primary a:not(.btn-cta):not(.btn-outline) { color: var(--color-neutral-100); }
footer.bg-primary a:not(.btn-cta):not(.btn-outline):hover { color: var(--color-accent); }
footer.bg-primary a:focus-visible { outline: 2px solid var(--color-cta); outline-offset: 2px; }

/* ---- Footer (on-dark) heading overrides ---- */
footer.bg-primary h1,
footer.bg-primary h2,
footer.bg-primary h3,
footer.bg-primary h4,
footer.bg-primary h5,
footer.bg-primary h6 { color: var(--color-neutral-100); }

/* ---- Responsive Adjustments ---- */
@media (max-width: 480px) {
  .section-title { @apply text-xl; }
  .btn           { @apply px-4 py-2 text-sm; }
  .category-tile { @apply p-4; }
  .tile-icon     { @apply w-9 h-9 mb-3; }
  .why-card      { @apply p-6; }
  .why-icon      { @apply w-10 h-10; }
}

/* Very small screens: compact share bar */
@media (max-width: 380px) {
  .share-bar .share-label{ display:none; }
  .share-bar .share-btn{ padding: .375rem .5rem; }
}

/* ---- In-article link decoration ---- */
.link-decor {
  text-decoration: none;
  border-bottom: 1px dotted currentColor;
  padding-bottom: 1px;
  transition: border-color .15s ease, color .15s ease;
}
.link-decor:hover { border-bottom-style: solid; }
.link-decor:focus-visible { outline: 2px solid var(--color-cta); outline-offset: 2px; }

/* Safe-area padding for sticky bars */
.safe-bottom { padding-bottom: env(safe-area-inset-bottom); }

/* === Testimonials ======================================================== */
@layer components {
  .testimonial{
    position:relative;
    display:flex; flex-direction:column;
    gap:.75rem;
    border-radius:1rem;
    background:#fff;
    box-shadow: 0 1px 2px rgb(0 0 0 / .06);
    border: 1px solid var(--color-neutral-200);
    padding: 1rem;
    transition: box-shadow .2s ease, transform .2s ease, border-color .2s ease;
  }
  @media (min-width: 640px){ .testimonial{ padding:1.1rem; } }
  @media (min-width: 1024px){ .testimonial{ padding:1.25rem; } }

  .testimonial:hover{
    box-shadow: 0 10px 20px rgb(0 0 0 / .08);
    transform: translateY(-2px);
    border-color: color-mix(in srgb, var(--color-cta) 26%, var(--color-neutral-200));
  }
  .testimonial:focus-visible{
    outline: 2px solid var(--color-cta);
    outline-offset: 2px;
  }

  .t-quote{
    width:28px; height:28px; border-radius:.5rem;
    display:grid; place-items:center;
    color: var(--color-cta);
    background: color-mix(in srgb, var(--color-cta) 10%, #fff);
    box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--color-cta) 30%, transparent);
  }
  .t-quote svg{ width:16px; height:16px; display:block; }

  .t-text{
    color:#0f172a;
    line-height:1.6;
    font-size:.95rem;
  }
  .t-text--clamp{ display:-webkit-box; -webkit-line-clamp:6; -webkit-box-orient:vertical; overflow:hidden; }

  .t-meta{ display:flex; align-items:center; gap:.75rem; margin-top:.25rem; }
  .t-avatar{
    width:40px; height:40px; border-radius:9999px; overflow:hidden; flex-shrink:0;
    background:#f1f5f9; box-shadow: inset 0 0 0 1px #e2e8f0;
  }
  .t-author{ font-weight:600; color: var(--color-primary); line-height:1.2; }
  .t-role{ font-size:.825rem; color:#64748b; }

  .t-stars{ display:flex; gap:.25rem; color:#d4a017; }
  .t-stars svg{ width:14px; height:14px; }
}

/* Optional: hide scrollbars on horizontal areas */
.scrollbar-hide{ scrollbar-width:none; }
.scrollbar-hide::-webkit-scrollbar{ display:none; }

/* ——— Fix: Prevent green focus ring “bleed” at top of page ——— */
header[role="banner"], .site-header {
  outline: none !important;
}
header[role="banner"]:focus, .site-header:focus {
  outline: none !important;
  box-shadow: none !important;
}

/* Optional polish for horizontal pill strips in page headers */
.overflow-x-auto > .flex {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}
