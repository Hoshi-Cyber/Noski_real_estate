---
import MainLayout from '../../../../layouts/MainLayout.astro';

const title = 'Selling FAQs | Severino Reality';
const description = 'Common questions about selling property.';
const guideUrl = '/resources/guides/selling';

const faqs = [
  { q:'Best time to list?', aHtml:'<p>When supply is low and demand is steady. Seasonality affects traffic; price to the market.</p>' },
  { q:'Do renovations pay back?', aHtml:'<p>Focus on high-ROI items: paint, lighting, minor repairs, curb appeal, kitchens/baths refresh.</p>' },
  { q:'How do you price?', aHtml:'<p>Recent comps, condition, and absorption. Choose a strategy: price-to-attract vs price-to-negotiate.</p>' },
  { q:'What is DOM and why it matters?', aHtml:'<p>Days on Market. Long DOM signals overpricing or issues and weakens negotiating power.</p>' },
  { q:'Handling multiple offers?', aHtml:'<p>Use an offer matrix. Compare net, contingencies, proof of funds, and closing dates.</p>' },
  { q:'What are my closing costs?', aHtml:'<p>Agency fees, legal, taxes, lien clearance, and agreed credits/repairs.</p>' },
];

const ld = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: faqs.map(f => ({ '@type':'Question', name:f.q, acceptedAnswer:{ '@type':'Answer', text:f.aHtml.replace(/<[^>]*>/g,'') } })),
};
---
<MainLayout {title} {description}>
  <section class="max-w-7xl mx-auto px-4 py-8 md:py-10">
    <header class="mb-6 md:mb-8">
      <h1 class="text-2xl md:text-3xl font-bold text-primary">Selling FAQs</h1>
      <div class="mt-3 flex items-center gap-3">
        <input id="faq-q" type="search" placeholder="Search Selling FAQs" class="w-full max-w-lg rounded-md ring-1 ring-neutral-300 px-3 py-2 text-sm" aria-label="Search Selling FAQs" />
        <a href={guideUrl} class="rounded-md px-3 py-2 bg-[color:var(--color-cta)] text-white text-sm">Read full Guide</a>
      </div>
    </header>

    <div id="faq-list" class="divide-y divide-neutral-200 rounded-md ring-1 ring-neutral-200 bg-white">
      {faqs.map(f => (
        <details class="group">
          <summary class="list-none cursor-pointer px-4 py-3 flex items-center justify-between">
            <span class="font-medium text-primary">{f.q}</span>
            <svg class="w-4 h-4 transition-transform group-open:rotate-180" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="px-4 pb-4 text-neutral-700 prose max-w-none" set:html={f.aHtml}></div>
        </details>
      ))}
    </div>

    <script type="application/ld+json">{JSON.stringify(ld)}</script>
  </section>

  <script type="module" client:load>
    const q = document.getElementById('faq-q');
    const list = document.getElementById('faq-list');

    // Filter
    q?.addEventListener('input', () => {
      const term = q.value.toLowerCase();
      list.querySelectorAll('details').forEach(d => {
        const t = d.querySelector('span')?.textContent?.toLowerCase() || '';
        d.classList.toggle('hidden', term && !t.includes(term));
      });
    });

    // One-open-only
    function closeOthers(except){
      list.querySelectorAll('details[open]').forEach(d => { if (d !== except) d.removeAttribute('open'); });
    }
    list?.addEventListener('toggle', (e) => {
      const d = e.target;
      if (d.tagName !== 'DETAILS') return;
      if (d.open) closeOthers(d);
    }, true);

    // Hash open
    const hash = decodeURIComponent(location.hash.slice(1));
    if (hash && list) {
      const match = [...list.querySelectorAll('details')].find(d =>
        (d.querySelector('span')?.textContent || '').toLowerCase().includes(hash.toLowerCase())
      );
      if (match) { closeOthers(match); match.open = true; }
    }
  </script>
</MainLayout>
