---
import MainLayout from '../../../../layouts/MainLayout.astro';

const title = 'Buying FAQs | Severino Reality';
const description = 'Common questions about buying property.';
const guideUrl = '/resources/guides/buying';

const faqs = [
  { q:'What down payment is typical?', aHtml:'<p>10–20% is common. Lower is possible with stricter terms.</p>' },
  { q:'How long does closing take?', aHtml:'<p>About 30–60 days from offer acceptance.</p>' },
  { q:'What costs should I budget for?', aHtml:'<p>Stamp duty, legal, valuation, inspection, loan fees, insurance.</p>' },
  { q:'Fixed vs. variable rate?', aHtml:'<p>Fixed = certainty. Variable = lower initial cost but rate risk.</p>' },
];
---
<MainLayout {title} {description}>
  <section class="max-w-7xl mx-auto px-4 py-8 md:py-10">
    <header class="mb-6 md:mb-8">
      <h1 class="text-2xl md:text-3xl font-bold text-primary">Buying FAQs</h1>
      <div class="mt-3 flex items-center gap-3">
        <input id="faq-q" type="search" placeholder="Search Buying FAQs"
               class="w-full max-w-lg rounded-md ring-1 ring-neutral-300 px-3 py-2 text-sm"
               aria-label="Search Buying FAQs" />
        <a href={guideUrl} class="rounded-md px-3 py-2 bg-[color:var(--color-cta)] text-white text-sm">
          Read full Guide
        </a>
      </div>
    </header>

    <div id="faq-list" class="divide-y divide-neutral-200 rounded-md ring-1 ring-neutral-200 bg-white">
      {faqs.map((f) => (
        <details class="group">
          <summary class="list-none cursor-pointer px-4 py-3 flex items-center justify-between">
            <span class="font-medium text-primary">{f.q}</span>
            <svg class="w-4 h-4 transition-transform group-open:rotate-180" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="px-4 pb-4 text-neutral-700 prose max-w-none" set:html={f.aHtml}></div>
        </details>
      ))}
    </div>

    <!-- One-open-only behavior + search filter -->
    <script type="module" client:load>
      const q = document.getElementById('faq-q');
      const list = document.getElementById('faq-list');

      // Filter by text
      q?.addEventListener('input', () => {
        const term = q.value.toLowerCase();
        list.querySelectorAll('details').forEach(d => {
          const t = d.querySelector('span')?.textContent?.toLowerCase() || '';
          d.classList.toggle('hidden', term && !t.includes(term));
        });
      });

      // Only one <details> open at a time
      function closeOthers(except){
        list.querySelectorAll('details[open]').forEach(d => { if (d !== except) d.removeAttribute('open'); });
      }
      list?.addEventListener('toggle', (e) => {
        const d = e.target;
        if (d.tagName !== 'DETAILS') return;
        if (d.open) closeOthers(d);
      }, true);

      // Optional: open item from hash
      const hash = decodeURIComponent(location.hash.slice(1));
      if (hash && list) {
        const match = [...list.querySelectorAll('details')].find(d =>
          (d.querySelector('span')?.textContent || '').toLowerCase().includes(hash.toLowerCase())
        );
        if (match) { closeOthers(match); match.open = true; }
      }
    </script>
  </section>
</MainLayout>
